<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>Custom Modification for admin/controller/catalog/product.php</name>
    <code>chat_gemini</code>
    <version>1.0</version>
    <author>Basheir Hassan</author>
    <link>Chat Gemini</link>


    <file path="admin/controller/catalog/product.php">


        <operation>
            <search><![CDATA[$this->load->language('catalog/product'); ]]></search>


            <add position="after"><![CDATA[

        //chat_gemini
               $this->document->addStyle('view/javascript/opc_gemini/loading/loading.css');
               $this->document->addScript('view/javascript/opc_gemini/loading/jquery.loading.min.js');
				]]></add>
        </operation>



    </file>



    <file path="admin/view/template/catalog/product_form.twig">
        <operation>
            <search><![CDATA[<script type="text/javascript" src="view/javascript/summernote/opencart.js"></script>]]></search>
            <add position="after"><![CDATA[



         <script type="text/javascript">
                    function loadGemini(languageID, languageName, objectName, description) {
                        var product_name = $('#input-name' + languageID);
                        var trimObject = $("#" + objectName + languageID);
                        var objectLoading =   (objectName === "input-description") ? $(trimObject).parent('div') : $(trimObject);

                        $(objectLoading).loading();


                        $.ajax({
                            url: 'index.php?route=extension/module/chat_gemini/getData&user_token={{ user_token }}',
                            type: 'post',
                            data: {gemini_content: $(product_name).val() + description},
                            dataType: 'json',
                            success: function (json) {

                                if (json.hasOwnProperty('error')) {
                                    alert(json.error.message);
                                     $(objectLoading).loading('stop');

                                    return;
                                }


                                  $(objectLoading).loading('stop');
                                let jsonVal = json.candidates[0].content.parts[0].text;

                                if (objectName === "input-description") {
                                    $(trimObject).summernote('code', jsonVal);
                                } else {
                                    $(trimObject).val(jsonVal);
                                }
                            },
                            error: function (request, error) {
                                console.log("Request: " + JSON.stringify(request));
                                 $(objectLoading).loading('stop');
                            }
                        });
                    }


                    $(document).ready(function () {


                        $.getJSON("index.php?route=extension/module/chat_gemini/get_status&user_token={{ user_token }}", function (json) {
                            console.log("JSON Data: " + json.result);


                            if (json.result == 1) {
                                {% for language in languages %}



                                $('#input-name{{ language.language_id }}').parent('div').addClass('input-group').append($('<span/>')
                                    .attr('role', 'button')
                                    .text('!')
                                    .addClass('input-group-addon btn btn-primary btn-sm')
                                    .click(function () {
                                        loadGemini({{ language.language_id }}, "{{ language.name }}", "input-description", "  وصف بسيط  منسق html body  ");
                                    }));


                                $('#input-meta-title{{ language.language_id }}').parent('div').addClass('input-group').append($('<span/>')
                                    .attr('role', 'button')
                                    .text('!')
                                    .addClass('input-group-addon btn btn-primary btn-sm')
                                    .click(function () {
                                        loadGemini({{ language.language_id }}, "{{ language.name }}", "input-meta-title", "كلمات مفتاحية مفصولة كل كلمة - ");
                                    }));

                                $('#input-meta-description{{ language.language_id }}').parent('div').addClass('input-group').append($('<span/>')
                                    .attr('role', 'button')
                                    .text('!')
                                    .addClass('input-group-addon btn btn-primary btn-sm')
                                    .click(function () {
                                        loadGemini({{ language.language_id }}, "{{ language.name }}", "input-meta-description", "   وصف ميتا تاج بسيط  ");
                                    }));


                                $('#input-meta-keyword{{ language.language_id }}').parent('div').addClass('input-group').append($('<span/>')
                                    .attr('role', 'button')
                                    .text('!')
                                    .addClass('input-group-addon btn btn-primary btn-sm')
                                    .click(function () {
                                        loadGemini({{ language.language_id }}, "{{ language.name }}", "input-meta-keyword", "  meta keyword  ");
                                    }));


                                $('#input-tag{{ language.language_id }}').parent('div').addClass('input-group').append($('<span/>')
                                    .attr('role', 'button')
                                    .text('!')
                                    .addClass('input-group-addon btn btn-primary btn-sm')
                                    .click(function () {
                                        loadGemini({{ language.language_id }}, "{{ language.name }}", "input-tag", " كلمات مفتاحية مفصولة كل كلمة بفاصلة  ");
                                    }));


                                console.log("{{ language.name }}", "XXX")
                                {% endfor %}

                            }

                        });


                    })


                </script>

         </script>


            ]]></add>
        </operation>

    </file>

</modification>
